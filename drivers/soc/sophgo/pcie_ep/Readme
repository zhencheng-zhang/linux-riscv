// dtb example for pcie ep

#define BM1690_PCIE_MODE
#define BM1690_EVB

#if defined BM1690_PCIE_MODE
		pcie_ep@0 {
			compatible = "sophgo,pcie-link-ep";
			chip_type = "bm1690";
			#address-cells = <2>;
			#size-cells = <2>;
			ranges;//this is must, must, must, must
			pcie_id = <0x0 0x0>;
			socket_id = <0x0 0x0>;
			speed = <0x0 0x5>;
			lane_num = <0x0 0x8>;
			func_num = <0x0 0x1>;

#if defined BM1690_EVB
			reg =   <0x6c 0x00000000 0x00000000 0x00300000>,
				<0x6c 0x00300000 0x00000000 0x00004000>,
				<0x6c 0x000c0c00 0x00000000 0x00001000>,
				<0x6c 0x007d0000 0x00000000 0x00001000>,
				<0x6c 0x00000000 0x00000000 0x01ffffff>;
#endif

#if defined PLD_C2C_1T16D
			//pcie1
			reg =   <0x6c 0x00400000 0x00000000 0x00300000>,
				<0x6c 0x00700000 0x00000000 0x00004000>,
				<0x6c 0x00780c00 0x00000000 0x00001000>,
				<0x6c 0x007d0000 0x00000000 0x00001000>,
				<0x6c 0x00000000 0x00000000 0x01ffffff>;
#endif

#if defined AI_MODE_2044REVB
			//cxp pcie9
			reg =   <0x6c 0x08400000 0x00000000 0x00300000>,
				<0x6c 0x08700000 0x00000000 0x00004000>,
				<0x6c 0x08780c00 0x00000000 0x00001000>,
				<0x6c 0x087d0000 0x00000000 0x00001000>,
				<0x6c 0x08400000 0x00000000 0x00fdffff>;
#endif
			reg-names = "dbi", "atu", "config", "c2c_top", "c2c_config_base";

			sophgo_card@0 {
				compatible = "sophgo,sophgo-card";
				reg = <0x70 0x10180000 0x00000000 0x00080000>,
					<0x70 0x50000000 0x00000000 0x00001000>,
					<0x70 0x101ff000 0x00000000 0x00001000>;
				reg-names = "share-memory", "top-reg", "config_file";

				host-channel-num = <1>;
				tpu-channel-num = <8>;
				media-channel-num = <0>;
				tx-channel = <0x0 0x2 0x4 0x6 0x8 0xa 0xc 0xe 0x10>;
				rx-channel = <0x1 0x3 0x5 0x7 0x9 0xb 0xd 0xf 0x11>;
				channel-size = <0x2000>;

				interrupt-parent = <&intc>;
				interrupts = <352>, <353>, <354>, <355>, <356>, <357>, <358>, <359>, <360>;
				clr-irq = <0x6E 0x10000000 0x00000000 0x00000000>,
						<0x6E 0x10000004 0x00000000 0x00000000>,
						<0x6E 0x10000008 0x00000000 0x00000000>,
						<0x6E 0x1000000c 0x00000000 0x00000000>,
						<0x6E 0x10000010 0x00000000 0x00000000>,
						<0x6E 0x10000014 0x00000000 0x00000000>,
						<0x6E 0x10000018 0x00000000 0x00000000>,
						<0x6E 0x1000001c 0x00000000 0x00000000>,
						<0x6E 0x10000020 0x00000000 0x00000000>;
				virtual-msi = <0x0 0x0 0x00000000 0x00000000>,
						<0x69 0x0cd00000 0x00000000 0x00000001>,
						<0x69 0x1cd00000 0x00000000 0x00000001>,
						<0x69 0x2cd00000 0x00000000 0x00000001>,
						<0x69 0x3cd00000 0x00000000 0x00000001>,
						<0x69 0x4cd00000 0x00000000 0x00000001>,
						<0x69 0x5cd00000 0x00000000 0x00000001>,
						<0x69 0x6cd00000 0x00000000 0x00000001>,
						<0x69 0x7cd00000 0x00000000 0x00000001>;
			};
		};
#else
		sophgo_card@0 {
				compatible = "sophgo,sophgo-card";
				reg = <0x70 0x10180000 0x00000000 0x00080000>,
					<0x70 0x50000000 0x00000000 0x00001000>,
					<0x70 0x101ff000 0x00000000 0x00001000>;
				reg-names = "share-memory", "top-reg", "config_file";

				host-channel-num = <1>;
				tpu-channel-num = <8>;
				media-channel-num = <0>;
				tx-channel = <0x0 0x2 0x4 0x6 0x8 0xa 0xc 0xe 0x10>;
				rx-channel = <0x1 0x3 0x5 0x7 0x9 0xb 0xd 0xf 0x11>;
				channel-size = <0x2000>;

				interrupt-parent = <&intc>;
				interrupts = <352>, <353>, <354>, <355>, <356>, <357>, <358>, <359>, <360>;
				clr-irq = <0x6E 0x10000000 0x00000000 0x00000000>,
						<0x6E 0x10000004 0x00000000 0x00000000>,
						<0x6E 0x10000008 0x00000000 0x00000000>,
						<0x6E 0x1000000c 0x00000000 0x00000000>,
						<0x6E 0x10000010 0x00000000 0x00000000>,
						<0x6E 0x10000014 0x00000000 0x00000000>,
						<0x6E 0x10000018 0x00000000 0x00000000>,
						<0x6E 0x1000001c 0x00000000 0x00000000>,
						<0x6E 0x10000020 0x00000000 0x00000000>;
				virtual-msi =   <0x6d 0x50000000 0x00000000 0x00000001>,
						<0x69 0x0cd00000 0x00000000 0x00000001>,
						<0x69 0x1cd00000 0x00000000 0x00000001>,
						<0x69 0x2cd00000 0x00000000 0x00000001>,
						<0x69 0x3cd00000 0x00000000 0x00000001>,
						<0x69 0x4cd00000 0x00000000 0x00000001>,
						<0x69 0x5cd00000 0x00000000 0x00000001>,
						<0x69 0x6cd00000 0x00000000 0x00000001>,
						<0x69 0x7cd00000 0x00000000 0x00000001>;
			};
#endif

pcie_ep@1 {
	compatible = "sophgo,C2C-link-ep";
	chip_type = "bm1690";
	#address-cells = <2>;
	#size-cells = <2>;
	pcie_id = <0x0 0x1>;
	socket_id = <0x0 0x0>;

	reg = <0x4 0x00000000 0x00000000 0x00001000>,
	      <0x4 0x00000000 0x00000000 0x00001000>,
	      <0x4 0x00000000 0x00000000 0x00001000>,
	      <0x4 0x00000000 0x00000000 0x00001000>;
	reg-names = "dbi", "atu", "config", "c2c_top";

	perst-gpio = <&gpio0 PERST_PIN GPIO_ACTIVE_LOW>; //for interrupt
};

// dtb example for 1684x
pcie_ep@0 {
	compatible = "sophgo,pcie-link-ep";
	chip_type = "bm1684x";
	#address-cells = <2>;
	#size-cells = <2>;
	ranges;//this is must, must, must, must

	reg = <0x0 0x5fa00000 0x00000000 0x200000>;
	reg-names = "config";

	sophgo_card@0 {
		compatible = "sophgo,sophgo-card";
		reg = <0x4 0x00000000 0x00000000 0x40000000>;
		// memory-region = <&vpu_reserved>;
		host-channel-num = <1>;
		tpu-channel-num = <1>;
		media-channel-num = <1>;
		tx-channel = <0x0 0x2 0x4 0x6 0x8>;
		rx-channel = <0x1 0x3 0x5 0x7 0x9>;
		channel-size = <0x2000>;
		interrupt-parent = <&gic>;
		interrupts = <GIC_SPI 48 IRQ_TYPE_LEVEL_HIGH>,
			<GIC_SPI 49 IRQ_TYPE_LEVEL_HIGH>;
		clr-irq = <0x00000000 0x5001019c 0x00000000 0x00000001>,
			<0x00000000 0x5001019c 0x00000000 0x00000002>;
		virtual-msi = <0x0 0 0x00000000 0x00000002>,
			<0x00000000 0x50010198 0x00000000 0x00000004>;
	};
};

